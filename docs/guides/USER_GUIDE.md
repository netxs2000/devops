# 用户接入与指标指南 (User & Metrics Guide)

**面向对象**: 研发工程师、Tech Lead、产品经理、PMO
**版本**: 3.9.0 (Modern Data Platform)
**日期**: 2026-01-02

---

## 1. 快速接入指南 (Onboarding Guide)

### 1.1 平台定位

本平台是基于 **Modern Data Stack (Dagster + dbt)** 构建的自动化效能中台。它通过“软件定义资产”的方式，确保您看到的每一个指标都有源可溯、有据可查。

### 1.2 自动同步机制

* **资产发现**: 系统利用 Dagster 编排图谱，每日定时从 GitLab, Jira, SonarQube, Jenkins 等系统拉取数据。
* **元数据检索**: 所有的项目、表结构、指标定义均可在 **DataHub** 中进行全文检索。如果您找不到某个指标的定义，请直接在 DataHub 搜索框输入关键词。

### 1.3 质量红线与 GE 校验

* 为了确保数据可信，系统集成了 **Great Expectations (GE)**。
* 如果您在看板上看到“数据质量预警”标志，说明该项目存在基础数据缺失（如工号未对齐、Jira 关键字段未填），请根据指引及时补全。

---

## 2. 核心指标与业务价值 (Metrics Dictionary)

### 2.1 精密交付效能 (Precision Flow)

#### 🚀 DORA 四大指标

* **部署频率 (DF)** / **变更前置时间 (LT)** / **变更失败率 (CFR)** / **平均修复时间 (MTTR)**。
* **新特性**: 结合 `mdm_calendar` 进行净工时扣除，为您剔除法定节假日对效能数据的干扰。

#### 🌊 流动效能 (Flow Efficiency)

* **定义**: `有效开发时长 / (有效开发时长 + 阻塞等待时长)`。
* **目标**: 提升流动效能意味着减少“跨部门推诿”和“资源等待”。

### 2.2 财务与 ROI 效能 (FinOps & ROI) 🌟

#### 💰 研发投入产出比 (ROI Score)

* **计算**: `(项目/产品带来的业务收益) / (累计投入的人力与基建成本)`。
* **价值**: 帮助 PMO 进行资源盘点，识别“低投入高产出”的项目并予以追加资源。

#### 🛡️ 研发资本化审计 (Capitalization Audit)

* 系统通过 dbt 模型自动区分 **CAPEX (功能开发)** 与 **OPEX (维护修复)**。
* **指南**: 为确保合规，请在 Jira/禅道 任务中正确标记任务类型。

### 2.3 架构与质量 (Architecture & Quality)

#### 🏚️ 架构脆性指数 (ABI)

* 衡量代码库的变更扩散程度。ABI 过高意味着“牵一发而动全身”，急需重构。

#### 🌡️ 技术债务 (Technical Debt)

* 基于 SonarQube 的修复成本模型。建议配合 **AI 风险评级** 优先处理核心模块的高危风险。

---

## 3. 进阶功能：数据血缘与治理 (Governance)

### 3.1 资产血缘 (Data Lineage)

如果您对某个指标的计算逻辑产生怀疑，可以登录 **DataHub** 查看该指标的“上游”：

1. 找到对应的 Mart 表（如 `fct_dora_metrics`）。
2. 点击 **Lineage** 标签，即可追溯到它依赖的原始 GitLab/Jira API 报文。

### 3.2 自助补录与 SCD Type 2

* **人员变更**: 系统采用 SCD Type 2 保留历史。如果您部门发生了人员调动，历史数据仍会归属到当时的部门。
* **日历调整**: 管理员可在 `mdm_calendar` 中补录特殊的调休或加班日，提升工时核算的精确度。

---

## 4. 交互与服务台 (Interactive Portal)

### 4.1 智能报障 (Service Desk)

* 支持通过门户提交 Bug。系统会利用 **SSE (Server-Sent Events)** 技术，在您的 Dashboard 右上角实时推送工单流转动态。

### 4.2 个人效能画像 (DNAPortrait)

* **雷达图**: 综合展现您的生产力、代码质量、协作深度与响应能力。
* **提升建议**: 系统会根据您的分值，智能化推荐“减少直推主干”、“增加 CR 互动深度”等具体行动。

---

## 5. 常见问题 (FAQ)

### Q: 为什么我在 DataHub 里搜不到我的项目？

A: 可能该项目尚未通过 Dagster 的初次摄取，或是在 `raw_data_staging` 阶段因 Schema 不匹配被 GE 拦截。请检查 GitLab 项目是否已包含 `type::` 相关的业务标签。

### Q: 系统如何保证敏感数据安全？

A: 核心数据受 RBAC 保护，所有的敏感操作（如手动调整 ROI 分数）都会记录在 `sync_logs` 的审计流中，并同步至 DataHub 审计日志。

### Q: 我发现计算逻辑有问题，怎么反馈？

A: 请在服务台提交“需求”类工单，并附上期望的计算公式，开发团队会通过 dbt 模型进行逻辑重演 (Replay)。

# 安全政策 (Security Policy)

**版本**: 4.1.0
**日期**: 2026-01-11

## 1. 受支持版本 (Supported Versions)

以下版本目前正在接受安全更新支持：

| 版本 | 支持状态 |
| :--- | :--- |
| 4.x | 积极支持 |
| 3.9.x | 安全补丁 |
| < 3.9 | 不再支持 |

---

## 2. 漏洞报告流程 (Reporting a Vulnerability)

如果您发现安全漏洞，请按以下流程进行负责任的披露：

### 2.1 报告方式

1. **首选方式**: 发送邮件至项目安全团队邮箱（请联系项目管理员获取）
2. **备选方式**: 在 GitLab 上创建 **Confidential Issue**，标题格式为 `[SECURITY] 简要描述`
3. **禁止公开披露**: 在修复方案发布前，请勿在公开渠道讨论漏洞细节

### 2.2 报告内容

请在报告中包含以下信息：

* **漏洞类型**: 如 SQL 注入、XSS、权限绕过等
* **受影响组件**: 如 `devops_portal/routers/auth.py`
* **复现步骤**: 详细的操作步骤和环境配置
* **潜在影响**: 您认为该漏洞可能造成的危害
* **建议修复方案** (可选): 如果您有修复建议

### 2.3 响应时间

| 优先级 | 初次响应 | 修复目标 |
| :--- | :--- | :--- |
| 紧急 (Critical) | 24 小时内 | 7 天 |
| 高危 (High) | 48 小时内 | 14 天 |
| 中危 (Medium) | 5 个工作日 | 30 天 |
| 低危 (Low) | 10 个工作日 | 按计划迭代 |

---

## 3. 安全最佳实践 (Security Best Practices)

### 3.1 配置安全

| 配置项 | 安全要求 | 检查方法 |
| :--- | :--- | :--- |
| **API Token** | 定期轮换（建议 90 天） | 检查 `.env` 文件 |
| **数据库密码** | 强密码策略（12+ 字符，含特殊字符） | 密码复杂度审计 |
| **JWT Secret** | 256 位随机密钥 | 检查 `SECURITY__SECRET_KEY` |
| **敏感配置** | 严禁提交至版本控制 | `.gitignore` 规则 |

### 3.2 环境隔离

```bash
# 生产环境配置检查清单
- [ ] .env 文件权限设置为 600
- [ ] 数据库仅监听内网地址
- [ ] RabbitMQ 管理端口不暴露外网
- [ ] Docker 容器以非 root 用户运行
```

### 3.3 网络安全

* **HTTPS**: 生产环境必须启用 TLS/SSL
* **防火墙**: 仅开放必要端口 (80, 443, 8000)
* **API 限速**: 建议配置 Nginx 限流策略
* **CORS**: 仅允许白名单域名跨域访问

### 3.4 认证与授权

* **JWT 令牌**: 默认有效期 24 小时，敏感操作需二次验证
* **OAuth2**: GitLab OAuth 回调地址需精确匹配
* **权限控制**: 遵循最小权限原则 (Least Privilege)

---

## 4. 依赖安全 (Dependency Security)

### 4.1 已集成安全扫描工具

| 工具 | 用途 | 配置位置 |
| :--- | :--- | :--- |
| **OWASP Dependency-Check** | CVE 漏洞扫描 | `docs/guides/OWASP_DEPENDENCY_CHECK_INTEGRATION.md` |
| **Bandit** | Python 静态安全分析 | `pyproject.toml` |
| **Safety** | Python 依赖漏洞检查 | CI Pipeline |

### 4.2 定期安全检查

```bash
# 手动执行依赖安全扫描
pip install safety
safety check -r requirements.txt

# OWASP Dependency-Check（需 Java 环境）
dependency-check --project "DevOps Platform" --scan .
```

### 4.3 高风险许可证

以下开源许可证在商业使用时需要额外评估：

| 许可证 | 风险等级 | 注意事项 |
| :--- | :--- | :--- |
| GPL-3.0 | 高危 | 强制开源衍生作品 |
| AGPL-3.0 | 高危 | 网络服务也需开源 |
| SSPL | 高危 | MongoDB 专用限制许可 |
| LGPL | 中危 | 动态链接可能豁免 |

---

## 5. 数据安全 (Data Security)

### 5.1 敏感数据处理

* **日志脱敏**: 禁止在日志中输出 Token、密码等敏感信息
* **数据加密**: 敏感字段采用 AES-256 加密存储
* **备份安全**: 数据库备份文件采用加密压缩

### 5.2 数据访问审计

系统内置以下审计功能：

* **登录审计**: 记录所有登录尝试（成功/失败）
* **API 访问**: 记录敏感 API 调用日志
* **数据导出**: 大批量数据导出触发告警

---

## 6. 安全事件响应 (Incident Response)

### 6.1 事件分级

| 级别 | 描述 | 示例 |
| :--- | :--- | :--- |
| P0 | 严重安全事件 | 数据泄露、生产系统入侵 |
| P1 | 高危安全事件 | 未授权访问、权限提升 |
| P2 | 中等安全事件 | 配置错误、弱密码 |
| P3 | 低危安全事件 | 信息泄露、日志异常 |

### 6.2 响应流程

```text
发现 -> 隔离 -> 分析 -> 修复 -> 复盘 -> 优化
```

1. **发现**: 通过监控、告警或人工报告发现问题
2. **隔离**: 必要时暂停受影响服务
3. **分析**: 确定根因和影响范围
4. **修复**: 部署安全补丁或配置变更
5. **复盘**: 编写事件报告，识别改进点
6. **优化**: 更新安全策略，防止再次发生

---

## 7. 合规性 (Compliance)

本项目遵循以下安全标准和最佳实践：

* **OWASP Top 10**: Web 应用安全风险防护
* **ISO 27001**: 信息安全管理体系
* **GDPR/PIPL**: 个人信息保护（如适用）

---

## 8. 联系方式 (Contact)

* **安全问题**: 请通过项目管理员获取安全团队联系方式
* **一般问题**: 提交 GitLab Issue
* **文档问题**: 提交 Merge Request
